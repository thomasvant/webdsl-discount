("0b580cfb3a8623453bb2d54d1bcb06bf3c964977",["src-generated/utils/TestAll.java"],JavaFile(["src-generated"],CompilationUnit(Some(PackageDec([],PackageName([Id("utils")]))),[TypeImportOnDemandDec(PackageName([Id("webdsl"),Id("generated"),Id("test")])),TypeImportDec(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("net")),Id("ServerSocket"))),TypeImportOnDemandDec(PackageName([Id("org"),Id("codehaus"),Id("cargo"),Id("container")])),TypeImportOnDemandDec(PackageName([Id("org"),Id("codehaus"),Id("cargo"),Id("container"),Id("deployable")])),TypeImportOnDemandDec(PackageName([Id("org"),Id("codehaus"),Id("cargo"),Id("container"),Id("tomcat")])),TypeImportOnDemandDec(PackageName([Id("org"),Id("codehaus"),Id("cargo"),Id("container"),Id("property")]))],[ClassDec(ClassDecHead([Public],Id("TestAll"),None,None,None),ClassBody([ConstrDec(ConstrDecHead([Public],None,Id("TestAll"),[],None),ConstrBody(None,[])),MethodDec(MethodDecHead([Public,Static],None,Void,Id("clearDB"),[],None),Block([LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(Id("org")),Id("hibernate")),Id("Session")),None),[VarDec(Id("hibSession"),Lit(Null))])),Try(Block([ExprStm(Assign(ExprName(Id("hibSession")),Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("HibernateUtil")),Id("getCurrentSession"))),[]))),ExprStm(Invoke(Method(MethodName(AmbName(Id("hibSession")),Id("beginTransaction"))),[])),ExprStm(Invoke(Method(Invoke(Method(Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("HibernateUtil")),Id("getCurrentSession"))),[]),None,Id("createQuery")),[Plus(Lit(String([Chars("delete from ")])),Lit(String([Chars("ApplicationContextProperty")])))]),None,Id("executeUpdate")),[])),ExprStm(Invoke(Method(Invoke(Method(Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("HibernateUtil")),Id("getCurrentSession"))),[]),None,Id("createQuery")),[Plus(Lit(String([Chars("delete from ")])),Lit(String([Chars("File")])))]),None,Id("executeUpdate")),[])),ExprStm(Invoke(Method(Invoke(Method(Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("HibernateUtil")),Id("getCurrentSession"))),[]),None,Id("createQuery")),[Plus(Lit(String([Chars("delete from ")])),Lit(String([Chars("SecurityContext")])))]),None,Id("executeUpdate")),[])),ExprStm(Invoke(Method(Invoke(Method(Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("HibernateUtil")),Id("getCurrentSession"))),[]),None,Id("createQuery")),[Plus(Lit(String([Chars("delete from ")])),Lit(String([Chars("dummy_webdsl_entity")])))]),None,Id("executeUpdate")),[])),ExprStm(Invoke(Method(Invoke(Method(Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("HibernateUtil")),Id("getCurrentSession"))),[]),None,Id("createQuery")),[Plus(Lit(String([Chars("delete from ")])),Lit(String([Chars("SessionManager")])))]),None,Id("executeUpdate")),[])),ExprStm(Invoke(Method(Invoke(Method(Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("HibernateUtil")),Id("getCurrentSession"))),[]),None,Id("createQuery")),[Plus(Lit(String([Chars("delete from ")])),Lit(String([Chars("SessionMessage")])))]),None,Id("executeUpdate")),[])),ExprStm(Invoke(Method(Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("HibernateUtil")),Id("getCurrentSession"))),[]),None,Id("flush")),[])),ExprStm(Invoke(Method(Invoke(Method(Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("HibernateUtil")),Id("getCurrentSession"))),[]),None,Id("getTransaction")),[]),None,Id("commit")),[]))]),[Catch(Param([],ClassOrInterfaceType(TypeName(Id("Exception")),None),Id("ex")),Block([ExprStm(Invoke(Method(MethodName(AmbName(AmbName(AmbName(AmbName(Id("org")),Id("webdsl")),Id("logging")),Id("Logger")),Id("error"))),[Plus(Lit(String([Chars("exception occurred while clearing database: ")])),Invoke(Method(MethodName(AmbName(Id("ex")),Id("getMessage"))),[])),ExprName(Id("ex"))])),ExprStm(Invoke(Method(Invoke(Method(Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("HibernateUtil")),Id("getCurrentSession"))),[]),None,Id("getTransaction")),[]),None,Id("rollback")),[]))]))])])),MethodDec(MethodDecHead([Public,Static],None,Void,Id("reloadGlobalVarsInit"),[Param([],ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(Id("org")),Id("hibernate")),Id("Session")),None),Id("hibSession"))],None),Block([ExprStm(Invoke(Method(MethodName(AmbName(Id("hibSession")),Id("beginTransaction"))),[])),ExprStm(Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("GlobalVariables")),Id("forceLoad"))),[])),ExprStm(Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("GlobalInit")),Id("forceLoad"))),[])),ExprStm(Invoke(Method(MethodName(AmbName(Id("hibSession")),Id("flush"))),[]))])),MethodDec(MethodDecHead([Public],None,Void,Id("beforeQuit"),[],None),Block([ExprStm(Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("Test")),Id("closeDrivers"))),[]))])),MethodDec(MethodDecHead([Public],None,Void,Id("runTests"),[],None),Block([LocalVarDecStm(LocalVarDec([],Boolean,[VarDec(Id("exitWithError"),Lit(Bool(False)))])),ExprStm(Invoke(Method(MethodName(Id("beforeQuit"))),[])),If(ExprName(Id("exitWithError")),Block([ExprStm(Invoke(Method(MethodName(AmbName(Id("System")),Id("exit"))),[Lit(Deci("1"))]))]))])),MethodDec(MethodDecHead([Public,Static],None,Void,Id("main"),[Param([],ArrayType(ClassOrInterfaceType(TypeName(Id("String")),None)),Id("args"))],None),Block([ExprStm(Invoke(Method(NewInstance(None,ClassOrInterfaceType(TypeName(Id("TestAll")),None),[],None),None,Id("runTests")),[])),ExprStm(Invoke(Method(MethodName(AmbName(Id("System")),Id("exit"))),[Lit(Deci("0"))]))])),FieldDec([Public,Static,Final],Boolean,[VarDec(Id("isPost"),Lit(Bool(False)))]),FieldDec([Public,Static],Int,[VarDec(Id("SERVLET_PORT"),Lit(Deci("8080")))]),FieldDec([Public,Static],Int,[VarDec(Id("RMI_PORT"),Lit(Deci("0")))]),FieldDec([Public,Static],Int,[VarDec(Id("DEBUG_PORT"),Lit(Deci("8000")))]),FieldDec([Public,Static],ClassOrInterfaceType(TypeName(Id("String")),None),[VarDec(Id("contextpath"))]),FieldDec([Public,Static],ClassOrInterfaceType(TypeName(Id("String")),None),[VarDec(Id("warfilename"))]),StaticInit(Block([Try(Block([LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("util")),Id("Properties")),None),[VarDec(Id("properties"),NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("util")),Id("Properties")),None),[],None))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("properties")),Id("load"))),[NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("io")),Id("FileInputStream")),None),[Lit(String([Chars("build.properties")]))],None)])),ExprStm(Assign(ExprName(Id("warfilename")),Invoke(Method(MethodName(AmbName(Id("properties")),Id("getProperty"))),[Lit(String([Chars("webdsl.warfilename")]))]))),If(Invoke(Method(MethodName(AmbName(Id("warfilename")),Id("equals"))),[Lit(String([Chars("ROOT")]))]),Block([ExprStm(Assign(ExprName(Id("contextpath")),Lit(String([]))))]),Block([ExprStm(Assign(ExprName(Id("contextpath")),Plus(Lit(String([Chars("/")])),ExprName(Id("warfilename")))))])),LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("String")),None),[VarDec(Id("servletPortArg"),Invoke(Method(MethodName(AmbName(Id("System")),Id("getProperty"))),[Lit(String([Chars("servletport")]))]))])),If(NotEq(ExprName(Id("servletPortArg")),Lit(Null)),Block([Try(Block([ExprStm(Assign(ExprName(Id("SERVLET_PORT")),Invoke(Method(MethodName(AmbName(Id("Integer")),Id("parseInt"))),[ExprName(Id("servletPortArg"))])))]),[Catch(Param([],ClassOrInterfaceType(TypeName(Id("NumberFormatException")),None),Id("ex")),Block([Throw(NewInstance(None,ClassOrInterfaceType(TypeName(Id("RuntimeException")),None),[ExprName(Id("ex"))],None))]))])]))]),[Catch(Param([],ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("io")),Id("IOException")),None),Id("ioe")),Block([Throw(NewInstance(None,ClassOrInterfaceType(TypeName(Id("RuntimeException")),None),[ExprName(Id("ioe"))],None))]))])])),MethodDec(MethodDecHead([Public],None,Void,Id("runInWebAppContainer"),[Param([],Boolean,Id("findPorts")),Param([],Boolean,Id("enableDebugging"))],None),Block([LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("DispatchServletHelper")),None),[VarDec(Id("d"),NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("DispatchServletHelper")),None),[Lit(Null),ExprName(Id("isPost")),ExprName(Id("contextpath"))],None))])),ExprStm(Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("ThreadLocalServlet")),Id("set"))),[ExprName(Id("d"))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("d")),Id("loadSessionManager"))),[Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("HibernateUtil")),Id("getCurrentSession"))),[]),Lit(Null)])),LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("String")),None),[VarDec(Id("warfile"),Plus(Plus(Lit(String([Chars("./")])),ExprName(Id("warfilename"))),Lit(String([Chars(".war")]))))])),ExprStm(Invoke(Method(MethodName(AmbName(AmbName(Id("System")),Id("out")),Id("println"))),[ExprName(Id("warfile"))])),LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("Deployable")),None),[VarDec(Id("war"),NewInstance(None,ClassOrInterfaceType(TypeName(Id("WAR")),None),[ExprName(Id("warfile"))],None))])),LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(Id("org")),Id("codehaus")),Id("cargo")),Id("container")),Id("configuration")),Id("LocalConfiguration")),None),[VarDec(Id("configuration"),NewInstance(None,ClassOrInterfaceType(TypeName(Id("Tomcat7xStandaloneLocalConfiguration")),None),[Lit(String([Chars("tomcat7x")]))],None))])),If(ExprName(Id("findPorts")),Block([Try(Block([LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("ServerSocket")),None),[VarDec(Id("ss1"),NewInstance(None,ClassOrInterfaceType(TypeName(Id("ServerSocket")),None),[Lit(Deci("0"))],None))])),LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("ServerSocket")),None),[VarDec(Id("ss2"),NewInstance(None,ClassOrInterfaceType(TypeName(Id("ServerSocket")),None),[Lit(Deci("0"))],None))])),LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("ServerSocket")),None),[VarDec(Id("ss3"),NewInstance(None,ClassOrInterfaceType(TypeName(Id("ServerSocket")),None),[Lit(Deci("0"))],None))])),ExprStm(Assign(ExprName(Id("SERVLET_PORT")),Invoke(Method(MethodName(AmbName(Id("ss1")),Id("getLocalPort"))),[]))),ExprStm(Assign(ExprName(Id("RMI_PORT")),Invoke(Method(MethodName(AmbName(Id("ss2")),Id("getLocalPort"))),[]))),ExprStm(Assign(ExprName(Id("DEBUG_PORT")),Invoke(Method(MethodName(AmbName(Id("ss3")),Id("getLocalPort"))),[]))),ExprStm(Invoke(Method(MethodName(AmbName(Id("ss1")),Id("close"))),[])),ExprStm(Invoke(Method(MethodName(AmbName(Id("ss2")),Id("close"))),[])),ExprStm(Invoke(Method(MethodName(AmbName(Id("ss3")),Id("close"))),[]))]),[Catch(Param([],ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("io")),Id("IOException")),None),Id("ioex")),Block([ExprStm(Invoke(Method(MethodName(AmbName(AmbName(AmbName(AmbName(Id("org")),Id("webdsl")),Id("logging")),Id("Logger")),Id("error"))),[Lit(String([Chars("Cannot find free port for test context.")])),ExprName(Id("ioex"))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("System")),Id("exit"))),[Lit(Deci("1"))]))]))]),ExprStm(Invoke(Method(MethodName(AmbName(Id("configuration")),Id("setProperty"))),[ExprName(AmbName(Id("GeneralPropertySet")),Id("RMI_PORT")),Invoke(Method(NewInstance(None,ClassOrInterfaceType(TypeName(Id("Integer")),None),[ExprName(Id("RMI_PORT"))],None),None,Id("toString")),[])]))])),ExprStm(Invoke(Method(MethodName(AmbName(AmbName(AmbName(AmbName(Id("org")),Id("webdsl")),Id("logging")),Id("Logger")),Id("info"))),[Plus(Lit(String([Chars("************Going to start tomcat on SERVLET_PORT: ")])),ExprName(Id("SERVLET_PORT")))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("configuration")),Id("setProperty"))),[ExprName(AmbName(Id("ServletPropertySet")),Id("PORT")),Invoke(Method(NewInstance(None,ClassOrInterfaceType(TypeName(Id("Integer")),None),[ExprName(Id("SERVLET_PORT"))],None),None,Id("toString")),[])])),ExprStm(Invoke(Method(MethodName(AmbName(Id("configuration")),Id("setProperty"))),[ExprName(AmbName(Id("TomcatPropertySet")),Id("AJP_PORT")),Invoke(Method(NewInstance(None,ClassOrInterfaceType(TypeName(Id("Integer")),None),[Plus(ExprName(Id("SERVLET_PORT")),Lit(Deci("1")))],None),None,Id("toString")),[])])),If(ExprName(Id("enableDebugging")),Block([ExprStm(Invoke(Method(MethodName(AmbName(Id("configuration")),Id("setProperty"))),[Lit(String([Chars("cargo.jvmargs")])),Plus(Plus(Plus(Plus(Lit(String([Chars("-Djava.security.egd=file:/dev/./urandom -Dservletport=")])),ExprName(Id("SERVLET_PORT"))),Lit(String([Chars(" -agentlib:jdwp=transport=dt_socket,address=")]))),ExprName(Id("DEBUG_PORT"))),Lit(String([Chars(",server=y,suspend=n -Xmx2g -XX:MaxPermSize=384m")])))]))]),Block([ExprStm(Invoke(Method(MethodName(AmbName(Id("configuration")),Id("setProperty"))),[Lit(String([Chars("cargo.jvmargs")])),Plus(Lit(String([Chars("-Djava.security.egd=file:/dev/./urandom -Dservletport=")])),ExprName(Id("SERVLET_PORT")))]))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("configuration")),Id("addDeployable"))),[ExprName(Id("war"))])),LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("InstalledLocalContainer")),None),[VarDec(Id("container"),NewInstance(None,ClassOrInterfaceType(TypeName(Id("Tomcat7xInstalledLocalContainer")),None),[ExprName(Id("configuration"))],None))])),LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("String")),None),[VarDec(Id("tomcathome"),Lit(String([Chars("./tomcat/tomcat/")])))])),ExprStm(Invoke(Method(MethodName(AmbName(AmbName(Id("System")),Id("out")),Id("println"))),[ExprName(Id("tomcathome"))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("container")),Id("setHome"))),[ExprName(Id("tomcathome"))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("container")),Id("setTimeout"))),[Lit(Deci("500000L"))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("container")),Id("setLogger"))),[NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(Id("org")),Id("codehaus")),Id("cargo")),Id("util")),Id("log")),Id("SimpleLogger")),None),[],Some(ClassBody([MethodDec(MethodDecHead([Protected],None,Void,Id("doLog"),[Param([],ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(Id("org")),Id("codehaus")),Id("cargo")),Id("util")),Id("log")),Id("LogLevel")),None),Id("level")),Param([],ClassOrInterfaceType(TypeName(Id("String")),None),Id("message")),Param([],ClassOrInterfaceType(TypeName(Id("String")),None),Id("category"))],None),Block([ExprStm(Invoke(Method(MethodName(AmbName(AmbName(Id("System")),Id("out")),Id("println"))),[ExprName(Id("message"))]))]))])))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("container")),Id("start"))),[])),ExprStm(Invoke(Method(MethodName(Id("runTests"))),[])),ExprStm(Invoke(Method(MethodName(AmbName(Id("container")),Id("stop"))),[])),ExprStm(Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("ThreadLocalServlet")),Id("set"))),[Lit(Null)]))]))]))])))